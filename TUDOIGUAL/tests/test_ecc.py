#!/usr/bin/env python
# -*- coding: utf-8 -*-

from __future__ import division, print_function, absolute_import
import sys
try:
    # tudoigual installed into system's python path?
    import tudoigual
except ImportError:
    import sys, os
    sys.path.insert(0, os.path.dirname(__file__) + '/../../')
    #sys.path.insert(0,'../../tudoigual')
    import tudoigual

import pytest
import hashlib
from binascii import unhexlify, hexlify
from tudoigual.ec.gen import ECPoint
from tudoigual.ec.hkdf import HKDF
from tudoigual.ec.ec_elgamal import EC_ElGamal
from tudoigual.utils.ec_curves import EC_curve_secp192r1, EC_curve_secp256r1, EC_curve_secp521r1

__author__ = "rcoliveira"
__copyright__ = "rcoliveira"
__license__ = "none"

"""
Test vectors from http://point-at-infinity.org/ecc/nisttv and https://tools.ietf.org/html/rfc6979#page-33
"""

P192_test_vectors = (
    #  Curve: P256
      # k
    ('1',
      # x
     '188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012',
      # y
     '07192B95FFC8DA78631011ED6B24CDD573F977A11E794811'),
      # k
    ('2',
      # x
     'DAFEBF5828783F2AD35534631588A3F629A70FB16982A888',
      # y
     'DD6BDA0D993DA0FA46B27BBC141B868F59331AFA5C7E93AB'),
      # k
    ('3',
      # x
     '76E32A2557599E6EDCD283201FB2B9AADFD0D359CBB263DA',
      # y
     '782C37E372BA4520AA62E0FED121D49EF3B543660CFD05FD'),
      # k
    ('4',
      # x
     '35433907297CC378B0015703374729D7A4FE46647084E4BA',
      # y
     'A2649984F2135C301EA3ACB0776CD4F125389B311DB3BE32'),
      # k
    ('5',
      # x
     '10BB8E9840049B183E078D9C300E1605590118EBDD7FF590',
      # y
     '31361008476F917BADC9F836E62762BE312B72543CCEAEA1'),
      # k
    ('6',
      # x
     'A37ABC6C431F9AC398BF5BD1AA6678320ACE8ECB93D23F2A',
      # y
     '851B3CAEC99908DBFED7040A1BBDA90E081F7C5710BC68F0'),
      # k
    ('7',
      # x
     '8DA75A1F75DDCD7660F923243060EDCE5DE37F007011FCFD',
      # y
     '57CB5FCF6860B35418240DB8FDB3C01DD4B702F96409FFB5'),
      # k
    ('8',
      # x
     '2FA1F92D1ECCE92014771993CC14899D4B5977883397EDDE',
      # y
     'A338AFDEF78B7214273B8B5978EF733FF2DD8A8E9738F6C0'),
      # k
    ('9',
      # x
     '818A4D308B1CABB74E9E8F2BA8D27C9E1D9D375AB980388F',
      # y
     '01D1AA5E208D87CD7C292F7CBB457CDF30EA542176C8E739'),
      # k
    ('10',
      # x
     'AA7C4F9EF99E3E96D1AEDE2BD9238842859BB150D1FE9D85',
      # y
     '3212A36547EDC62901EE3658B2F4859460EB5EB2491397B0'),
      # k
    ('11',
      # x
     '1C995995EB76324F1844F7164D22B652280940370628A2AA',
      # y
     'EF1765CE37E9EB73029F556400FA77BDB34CB8611AAA9C04'),
    # k
    ('12',
      # x
     '1061343F3D456D0ECA013877F8C9E7B28FCCDCDA67EEB8AB',
      # y
     '5A064CAA2EA6B03798FEF8E3E7A48648681EAC020B27293F'),
    # k
    ('13',
      # x
     '112AF141D33EFB9F2F68821E051E4EA004144A363C4A090A',
      # y
     '6E0CBE3BFC5293F72A2C1726E081E09E7F10A094432B1C1E'),
    # k
    ('14',
      # x
     '13B9310646EBC93B591746B3F7C64E05DEE08843DE1081C1',
      # y
     '1EDCEA63B44142DD15F3B427EC41A1EC4FBACA95E186E6B4'),
    # k
    ('15',
      # x
     '8C9595E63B56B633BA3546B2B5414DE736DE4A9E7578B1E7',
      # y
     '266B762A934F00C17CF387993AA566B6AD7537CDD98FC7B1'),
    # k
    ('16',
      # x
     'B7310B4548FBFDBD29005092A5355BFCD99473733048AFDF',
      # y
     'FF9EAE9EDCD27C1E42D8585C4546D9491845C56629CF2290'),
    # k
    ('17',
      # x
     '44275CD2E1F46DC3F9F57636C2B4213B8BB445930510FF8A',
      # y
     'EFAD8348FDE30C87DE438612A818E98D9B76A67AD25DDFD0'),
    # k
    ('18',
      # x
     'C1B4DB0227210613A6CA15C428024E40B6513365D72591A3',
      # y
     '1E26B286BCA1D08F4FE8F801267DF9FD7782EC3EC3F47F53'),
    # k
    ('19',
      # x
     'C0626BCF247DE5D307FD839238D72688774FC97A1CF8AD1B',
      # y
     '9CDC99D753973DC197E12778E829C804EC1A6B4E71FAA20A'),
    # k
    ('20',
      # x
     'BB6F082321D34DBD786A1566915C6DD5EDF879AB0F5ADD67',
      # y
     '91E4DD8A77C4531C8B76DEF2E5339B5EB95D5D9479DF4C8D'),
      # k
    ('112233445566778899',
      # x
     '81E6E0F14C9302C8A8DCA8A038B73165E9687D0490CD9F85',
      # y
     'F58067119EED8579388C4281DC645A27DB7764750E812477'),
      # k
    ('112233445566778899112233445566778899',
      # x
     'B357B10AC985C891B29FB37DA56661CCCF50CEC21128D4F6',
      # y
     'BA20DC2FA1CC228D3C2D8B538C2177C2921884C6B7F0D96F'),
      # k
    ('1618292094200346491064154703205151664562462359653015613567',
      # x
     '74FEC215F253C6BD845831E059B318C87F727B136A700B91',
      # y
     '4B702B15B126A703E7A7CEC3E0EC81F8DFCA73A59F5D88B9'),
      # k
    #('1484605055214526729816930749766694384906446681761906688',
      # x
    # '0C40230F9C4B8C0FD91F2C604FCBA9B87C2DFA153F010B4F',
      # y
    # '5FC4F5771F467971B2C82752413833A68CE00F4A9A692B02'),
      # k
    ('1569275434166462877105627261392580354519833538813866540831',
      # x
     '28783BBF6208E1FF0F965FD8DC0C26FF1D8E02B433EDF2F7',
      # y
     'A5852BBC44FD8164C1ABA9A3EC7A88E461D5D77ABD743E87'),
      # k
    ('3138550867681922400546388175470823984762234518836963313664',
      # x
     '45DAF0A306121BDB3B82E734CB44FDF65C9930F0E4FD2068',
      # y
     'F039FACE58EB7DE34E3374ADB28DF81F019C4548BAA75B64'),
      # k
    ('3138550119404545973088374812479323842475901485681169401600',
      # x
     '1D5EC85004EA2ABA905CEF98A818A8C3516D7CB69A6FD575',
      # y
     '4008F35F5820F66C902195644162E5AA231DD69C9E1ECC97'),
      # k
    ('24519928471166604179655321383971467003990211439919824896',
      # x
     'F063727C2EA4D358AB02F6B0BEEB14DBEAF2E8A1DB3208EE',
      # y
     '427418C015553361769B6A0C42923C4CA103740B6DCD9703'),
      # k
    ('46756768218837031708063422466358611246556475572231',
      # x
     'DC81D33CA6604B1EFE49386CD492979EF807B8BAEB8566E3',
      # y
     'D454247FF478514556333B3901C9F1CCC18DBC9AB938CFA0'),
      # k
    ('3138502977207688322901699644928655553044791844086883549215',
      # x
     'D932741DF6AA0E1EED24279150436C752AA5ADCFD0698D72',
      # y
     '9759B6D2EF21D885E94CDFF219F17004D8763401DAB021B5'),
      # k
    ('47890485652059026491391979477371914515865621847605503',
      # x
     '571477E9D9F2A628780742257F7250C4224C483B30F3A97E',
      # y
     '1AD35EE3177D22DD5F01B5A46FFDEC547B6A41786EBB8C8F'),
      # k
    ('3138549376958826959341570842566593375326996431013993775615',
      # x
     '4C69939642792776C826DB8B4EBF4BD8C03FC9DFA2AEC822',
      # y
     '29BF35BE52A6036E07EBA5741CFEB4C143310216EF1B9A2E'),
      # k
    ('6277101735386680763835789423176059013767194773182842284061',
      # x
     'BB6F082321D34DBD786A1566915C6DD5EDF879AB0F5ADD67',
      # y
     '6E1B2275883BACE37489210D1ACC64A046A2A26B8620B372'),
      # k
    ('6277101735386680763835789423176059013767194773182842284062',
      # x
     'C0626BCF247DE5D307FD839238D72688774FC97A1CF8AD1B',
      # y
     '63236628AC68C23E681ED88717D637FA13E594B18E055DF5'),
      # k
    ('6277101735386680763835789423176059013767194773182842284063',
      # x
     'C1B4DB0227210613A6CA15C428024E40B6513365D72591A3',
      # y
     'E1D94D79435E2F70B01707FED9820601887D13C13C0B80AC'),
      # k
    ('6277101735386680763835789423176059013767194773182842284064',
      # x
     '44275CD2E1F46DC3F9F57636C2B4213B8BB445930510FF8A',
      # y
     '10527CB7021CF37821BC79ED57E71671648959852DA2202F'),
      # k
    ('6277101735386680763835789423176059013767194773182842284065',
      # x
     'B7310B4548FBFDBD29005092A5355BFCD99473733048AFDF',
      # y
     '00615161232D83E1BD27A7A3BAB926B5E7BA3A99D630DD6F'),
      # k
    ('6277101735386680763835789423176059013767194773182842284066',
      # x
     '8C9595E63B56B633BA3546B2B5414DE736DE4A9E7578B1E7',
      # y
     'D99489D56CB0FF3E830C7866C55A9948528AC8322670384E'),
      # k
    ('6277101735386680763835789423176059013767194773182842284067',
      # x
     '13B9310646EBC93B591746B3F7C64E05DEE08843DE1081C1',
      # y
     'E123159C4BBEBD22EA0C4BD813BE5E12B045356A1E79194B'),
      # k
    ('6277101735386680763835789423176059013767194773182842284068',
      # x
     '112AF141D33EFB9F2F68821E051E4EA004144A363C4A090A',
      # y
     '91F341C403AD6C08D5D3E8D91F7E1F6080EF5F6BBCD4E3E1'),
      # k
    ('6277101735386680763835789423176059013767194773182842284069',
      # x
     '1061343F3D456D0ECA013877F8C9E7B28FCCDCDA67EEB8AB',
      # y
     'A5F9B355D1594FC86701071C185B79B697E153FDF4D8D6C0'),
      # k
    ('6277101735386680763835789423176059013767194773182842284070',
      # x
     '1C995995EB76324F1844F7164D22B652280940370628A2AA',
      # y
     '10E89A31C816148CFD60AA9BFF0588414CB3479EE55563FB'),
      # k
    ('6277101735386680763835789423176059013767194773182842284071',
      # x
     'AA7C4F9EF99E3E96D1AEDE2BD9238842859BB150D1FE9D85',
      # y
     'CDED5C9AB81239D6FE11C9A74D0B7A6A9F14A14DB6EC684F'),
      # k
    ('6277101735386680763835789423176059013767194773182842284072',
      # x
     '818A4D308B1CABB74E9E8F2BA8D27C9E1D9D375AB980388F',
      # y
     'FE2E55A1DF72783283D6D08344BA831FCF15ABDE893718C6'),
      # k
    ('6277101735386680763835789423176059013767194773182842284073',
      # x
     '2FA1F92D1ECCE92014771993CC14899D4B5977883397EDDE',
      # y
     '5CC7502108748DEBD8C474A687108CBF0D22757168C7093F'),
      # k
    ('6277101735386680763835789423176059013767194773182842284074',
      # x
     '8DA75A1F75DDCD7660F923243060EDCE5DE37F007011FCFD',
      # y
     'A834A030979F4CABE7DBF247024C3FE12B48FD069BF6004A'),
      # k
    ('6277101735386680763835789423176059013767194773182842284075',
      # x
     'A37ABC6C431F9AC398BF5BD1AA6678320ACE8ECB93D23F2A',
      # y
     '7AE4C3513666F7240128FBF5E44256F0F7E083A8EF43970F'),
      # k
    ('6277101735386680763835789423176059013767194773182842284076',
      # x
     '10BB8E9840049B183E078D9C300E1605590118EBDD7FF590',
      # y
     'CEC9EFF7B8906E84523607C919D89D40CED48DABC331515E'),
      # k
    ('6277101735386680763835789423176059013767194773182842284077',
      # x
     '35433907297CC378B0015703374729D7A4FE46647084E4BA',
      # y
     '5D9B667B0DECA3CFE15C534F88932B0DDAC764CEE24C41CD'),
      # k
    ('6277101735386680763835789423176059013767194773182842284078',
      # x
     '76E32A2557599E6EDCD283201FB2B9AADFD0D359CBB263DA',
      # y
     '87D3C81C8D45BADF559D1F012EDE2B600C4ABC99F302FA02'),
      # k
    ('6277101735386680763835789423176059013767194773182842284079',
      # x
     'DAFEBF5828783F2AD35534631588A3F629A70FB16982A888',
      # y
     '229425F266C25F05B94D8443EBE4796FA6CCE505A3816C54'),
      # k
    ('6277101735386680763835789423176059013767194773182842284080',
      # x
     '188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012',
      # y
     'F8E6D46A003725879CEFEE1294DB32298C06885EE186B7EE'),
)

P192_sign_test_vectors = (
    #  Curve: P256
      # hash functions
    (hashlib.sha1,
      # sample
     'sample',
      # k
     '37D7CA00D2C7B0E5E412AC03BD44BA837FDD5B28CD3B0021',
      # r
     '98C6BD12B23EAF5E2A2045132086BE3EB8EBD62ABF6698FF',
      # s
     '57A22B07DEA9530F8DE9471B1DC6624472E8E2844BC25B64'),
      # hash functions
    #(hashlib.sha1,
      # sample
    # 'test',
      # k
    # 'D9CF9C3D3297D3260773A1DA7418DB5537AB8DD93DE7FA25',
      # r
    # '0F2141A0EBBC44D2E1AF90A50EBCFCE5E197B3B7D4DE036D',
      # s
    # 'EB18BC9E1F3D7387500CB99CF5F7C157070A8961E38700B7'),
      # hash functions
    (hashlib.sha224,
      # sample
     'sample',
      # k
     '4381526B3FC1E7128F202E194505592F01D5FF4C5AF015D8',
      # r
     'A1F00DAD97AEEC91C95585F36200C65F3C01812AA60378F5',
      # s
     'E07EC1304C7C6C9DEBBE980B9692668F81D4DE7922A0F97A'),
    (hashlib.sha224,
      # sample
     'test',
      # k
     'F5DC805F76EF851800700CCE82E7B98D8911B7D510059FBE',
      # r
     '6945A1C1D1B2206B8145548F633BB61CEF04891BAF26ED34',
      # s
     'B7FB7FDFC339C0B9BD61A9F5A8EAF9BE58FC5CBA2CB15293'),
      # hash functions
    (hashlib.sha256,
      # sample
     'sample',
      # k
     '32B1B6D7D42A05CB449065727A84804FB1A3E34D8F261496',
      # r
     '4B0B8CE98A92866A2820E20AA6B75B56382E0F9BFD5ECB55',
      # s
     'CCDB006926EA9565CBADC840829D8C384E06DE1F1E381B85'),
    (hashlib.sha256,
      # sample
     'test',
      # k
     '5C4CE89CF56D9E7C77C8585339B006B97B5F0680B4306C6C',
      # r
     '3A718BD8B4926C3B52EE6BBE67EF79B18CB6EB62B1AD97AE',
      # s
     '5662E6848A4A19B1F1AE2F72ACD4B8BBE50F1EAC65D9124F'),
      # hash functions
    (hashlib.sha384,
      # sample
     'sample',
      # k
     '4730005C4FCB01834C063A7B6760096DBE284B8252EF4311',
      # r
     'DA63BF0B9ABCF948FBB1E9167F136145F7A20426DCC287D5',
      # s
     'C3AA2C960972BD7A2003A57E1C4C77F0578F8AE95E31EC5E'),
      # hash functions
    (hashlib.sha384,
      # sample
     'test',
      # k
     '5AFEFB5D3393261B828DB6C91FBC68C230727B030C975693',
      # r
     'B234B60B4DB75A733E19280A7A6034BD6B1EE88AF5332367',
      # s
     '7994090B2D59BB782BE57E74A44C9A1C700413F8ABEFE77A'),
      # hash functions
    (hashlib.sha512,
      # sample
     'sample',
      # k
     'A2AC7AB055E4F20692D49209544C203A7D1F2C0BFBC75DB1',
      # r
     '4D60C5AB1996BD848343B31C00850205E2EA6922DAC2E4B8',
      # s
     '3F6E837448F027A1BF4B34E796E32A811CBB4050908D8F67'),
    # hash functions
    (hashlib.sha512,
      # sample
     'test',
      # k
     '0758753A5254759C7CFBAD2E2D9B0792EEE44136C9480527',
      # r
     'FE4F4AE86A58B6507946715934FE2D8FF9D95B6B098FE739',
      # s
     '74CF5605C98FBA0E1EF34D4B5A1577A7DCF59457CAE52290'),
)

P256_test_vectors = (
    #  Curve: P256
      # k
    ('1',
      # x
     '6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296',
      # y
     '4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5'),
      # k
    ('2',
      # x
     '7CF27B188D034F7E8A52380304B51AC3C08969E277F21B35A60B48FC47669978',
      # y
     '07775510DB8ED040293D9AC69F7430DBBA7DADE63CE982299E04B79D227873D1'),
      # k
    ('3',
      # x
     '5ECBE4D1A6330A44C8F7EF951D4BF165E6C6B721EFADA985FB41661BC6E7FD6C',
      # y
     '8734640C4998FF7E374B06CE1A64A2ECD82AB036384FB83D9A79B127A27D5032'),
      # k
    ('4',
      # x
     'E2534A3532D08FBBA02DDE659EE62BD0031FE2DB785596EF509302446B030852',
      # y
     'E0F1575A4C633CC719DFEE5FDA862D764EFC96C3F30EE0055C42C23F184ED8C6'),
      # k
    ('5',
      # x
     '51590B7A515140D2D784C85608668FDFEF8C82FD1F5BE52421554A0DC3D033ED',
      # y
     'E0C17DA8904A727D8AE1BF36BF8A79260D012F00D4D80888D1D0BB44FDA16DA4'),
      # k
    ('6',
      # x
     'B01A172A76A4602C92D3242CB897DDE3024C740DEBB215B4C6B0AAE93C2291A9',
      # y
     'E85C10743237DAD56FEC0E2DFBA703791C00F7701C7E16BDFD7C48538FC77FE2'),
      # k
    ('7',
      # x
     '8E533B6FA0BF7B4625BB30667C01FB607EF9F8B8A80FEF5B300628703187B2A3',
      # y
     '73EB1DBDE03318366D069F83A6F5900053C73633CB041B21C55E1A86C1F400B4'),
      # k
    ('8',
      # x
     '62D9779DBEE9B0534042742D3AB54CADC1D238980FCE97DBB4DD9DC1DB6FB393',
      # y
     'AD5ACCBD91E9D8244FF15D771167CEE0A2ED51F6BBE76A78DA540A6A0F09957E'),
      # k
    ('9',
      # x
     'EA68D7B6FEDF0B71878938D51D71F8729E0ACB8C2C6DF8B3D79E8A4B90949EE0',
      # y
     '2A2744C972C9FCE787014A964A8EA0C84D714FEAA4DE823FE85A224A4DD048FA'),
      # k
    ('10',
      # x
     'CEF66D6B2A3A993E591214D1EA223FB545CA6C471C48306E4C36069404C5723F',
      # y
     '878662A229AAAE906E123CDD9D3B4C10590DED29FE751EEECA34BBAA44AF0773'),
      # k
    ('11',
      # x
     '3ED113B7883B4C590638379DB0C21CDA16742ED0255048BF433391D374BC21D1',
      # y
     '9099209ACCC4C8A224C843AFA4F4C68A090D04DA5E9889DAE2F8EEFCE82A3740'),
    # k
    ('12',
      # x
     '741DD5BDA817D95E4626537320E5D55179983028B2F82C99D500C5EE8624E3C4',
      # y
     '0770B46A9C385FDC567383554887B1548EEB912C35BA5CA71995FF22CD4481D3'),
    # k
    ('13',
      # x
     '177C837AE0AC495A61805DF2D85EE2FC792E284B65EAD58A98E15D9D46072C01',
      # y
     '63BB58CD4EBEA558A24091ADB40F4E7226EE14C3A1FB4DF39C43BBE2EFC7BFD8'),
    # k
    ('14',
      # x
     '54E77A001C3862B97A76647F4336DF3CF126ACBE7A069C5E5709277324D2920B',
      # y
     'F599F1BB29F4317542121F8C05A2E7C37171EA77735090081BA7C82F60D0B375'),
    # k
    ('15',
      # x
     'F0454DC6971ABAE7ADFB378999888265AE03AF92DE3A0EF163668C63E59B9D5F',
      # y
     'B5B93EE3592E2D1F4E6594E51F9643E62A3B21CE75B5FA3F47E59CDE0D034F36'),
    # k
    ('16',
      # x
     '76A94D138A6B41858B821C629836315FCD28392EFF6CA038A5EB4787E1277C6E',
      # y
     'A985FE61341F260E6CB0A1B5E11E87208599A0040FC78BAA0E9DDD724B8C5110'),
    # k
    ('17',
      # x
     '47776904C0F1CC3A9C0984B66F75301A5FA68678F0D64AF8BA1ABCE34738A73E',
      # y
     'AA005EE6B5B957286231856577648E8381B2804428D5733F32F787FF71F1FCDC'),
    # k
    ('18',
      # x
     '1057E0AB5780F470DEFC9378D1C7C87437BB4C6F9EA55C63D936266DBD781FDA',
      # y
     'F6F1645A15CBE5DC9FA9B7DFD96EE5A7DCC11B5C5EF4F1F78D83B3393C6A45A2'),
    # k
    ('19',
      # x
     'CB6D2861102C0C25CE39B7C17108C507782C452257884895C1FC7B74AB03ED83',
      # y
     '58D7614B24D9EF515C35E7100D6D6CE4A496716E30FA3E03E39150752BCECDAA'),
    # k
    ('20',
      # x
     '83A01A9378395BAB9BCD6A0AD03CC56D56E6B19250465A94A234DC4C6B28DA9A',
      # y
     '76E49B6DE2F73234AE6A5EB9D612B75C9F2202BB6923F54FF8240AAA86F640B8'),
    # k
    ('112233445566778899',
      # x
     '339150844EC15234807FE862A86BE77977DBFB3AE3D96F4C22795513AEAAB82F',
      # y
     'B1C14DDFDC8EC1B2583F51E85A5EB3A155840F2034730E9B5ADA38B674336A21'
      ),
      # k
    ('112233445566778899112233445566778899',
      # x
     '1B7E046A076CC25E6D7FA5003F6729F665CC3241B5ADAB12B498CD32F2803264',
      # y
     'BFEA79BE2B666B073DB69A2A241ADAB0738FE9D2DD28B5604EB8C8CF097C457B'
      ),
      # k
    ('29852220098221261079183923314599206100666902414330245206392788703677545185283',
      # x
     '9EACE8F4B071E677C5350B02F2BB2B384AAE89D58AA72CA97A170572E0FB222F',
      # y
     '1BBDAEC2430B09B93F7CB08678636CE12EAAFD58390699B5FD2F6E1188FC2A78'
      ),
      # k
    ('57896042899961394862005778464643882389978449576758748073725983489954366354431',
      # x
     '878F22CC6DB6048D2B767268F22FFAD8E56AB8E2DC615F7BD89F1E350500DD8D',
      # y
     '714A5D7BB901C9C5853400D12341A892EF45D87FC553786756C4F0C9391D763E'
      ),
      # k
    ('1766845392945710151501889105729049882997660004824848915955419660366636031',
      # x
     '659A379625AB122F2512B8DADA02C6348D53B54452DFF67AC7ACE4E8856295CA',
      # y
     '49D81AB97B648464D0B4A288BD7818FAB41A16426E943527C4FED8736C53D0F6'
      ),
      # k
    ('28948025760307534517734791687894775804466072615242963443097661355606862201087',
      # x
     'CBCEAAA8A4DD44BBCE58E8DB7740A5510EC2CB7EA8DA8D8F036B3FB04CDA4DE4',
      # y
     '4BD7AA301A80D7F59FD983FEDBE59BB7B2863FE46494935E3745B360E32332FA'
      ),
      # k
    ('113078210460870548944811695960290644973229224625838436424477095834645696384',
      # x
     'F0C4A0576154FF3A33A3460D42EAED806E854DFA37125221D37935124BA462A4',
      # y
     '5B392FA964434D29EEC6C9DBC261CF116796864AA2FAADB984A2DF38D1AEF7A3'
      ),
      # k
    ('12078056106883488161242983286051341125085761470677906721917479268909056',
      # x
     '5E6C8524B6369530B12C62D31EC53E0288173BD662BDF680B53A41ECBCAD00CC',
      # y
     '447FE742C2BFEF4D0DB14B5B83A2682309B5618E0064A94804E9282179FE089F'
      ),
      # k
    #('57782969857385448082319957860328652998540760998293976083718804450708503920639',
      # x
    # '03792E541BC209076A3D7920A915021ECD396A6EB5C3960024BE5575F3223484',
      # y
    # 'FC774AE092403101563B712F68170312304F20C80B40C06282063DB25F268DE4'
    #  ),
      # k
    ('57896017119460046759583662757090100341435943767777707906455551163257755533312',
      # x
     '2379FF85AB693CDF901D6CE6F2473F39C04A2FE3DCD842CE7AAB0E002095BCF8',
      # y
     'F8B476530A634589D5129E46F322B02FBC610A703D80875EE70D7CE1877436A1'
      ),
      # k
    ('452312848374287284681282171017647412726433684238464212999305864837160993279',
      # x
     'C1E4072C529BF2F44DA769EFC934472848003B3AF2C0F5AA8F8DDBD53E12ED7C',
      # y
     '39A6EE77812BB37E8079CD01ED649D3830FCA46F718C1D3993E4A591824ABCDB'
      ),
      # k
    ('904571339174065134293634407946054000774746055866917729876676367558469746684',
      # x
     '34DFBC09404C21E250A9B40FA8772897AC63A094877DB65862B61BD1507B34F3',
      # y
     'CF6F8A876C6F99CEAEC87148F18C7E1E0DA6E165FFC8ED82ABB65955215F77D3'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044349',
      # x
     '83A01A9378395BAB9BCD6A0AD03CC56D56E6B19250465A94A234DC4C6B28DA9A',
      # y
     '891B64911D08CDCC5195A14629ED48A360DDFD4596DC0AB007DBF5557909BF47'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044350',
      # x
     'CB6D2861102C0C25CE39B7C17108C507782C452257884895C1FC7B74AB03ED83',
      # y
     'A7289EB3DB2610AFA3CA18EFF292931B5B698E92CF05C1FC1C6EAF8AD4313255'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044351',
      # x
     '1057E0AB5780F470DEFC9378D1C7C87437BB4C6F9EA55C63D936266DBD781FDA',
      # y
     '090E9BA4EA341A246056482026911A58233EE4A4A10B0E08727C4CC6C395BA5D'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044352',
      # x
     '47776904C0F1CC3A9C0984B66F75301A5FA68678F0D64AF8BA1ABCE34738A73E',
      # y
     '55FFA1184A46A8D89DCE7A9A889B717C7E4D7FBCD72A8CC0CD0878008E0E0323'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044353',
      # x
     '76A94D138A6B41858B821C629836315FCD28392EFF6CA038A5EB4787E1277C6E',
      # y
     '567A019DCBE0D9F2934F5E4A1EE178DF7A665FFCF0387455F162228DB473AEEF'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044354',
      # x
     'F0454DC6971ABAE7ADFB378999888265AE03AF92DE3A0EF163668C63E59B9D5F',
      # y
     '4A46C11BA6D1D2E1B19A6B1AE069BC19D5C4DE328A4A05C0B81A6321F2FCB0C9'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044355',
      # x
     '54E77A001C3862B97A76647F4336DF3CF126ACBE7A069C5E5709277324D2920B',
      # y
     '0A660E43D60BCE8BBDEDE073FA5D183C8E8E15898CAF6FF7E45837D09F2F4C8A'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044356',
      # x
     '177C837AE0AC495A61805DF2D85EE2FC792E284B65EAD58A98E15D9D46072C01',
      # y
     '9C44A731B1415AA85DBF6E524BF0B18DD911EB3D5E04B20C63BC441D10384027'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044357',
      # x
     '741DD5BDA817D95E4626537320E5D55179983028B2F82C99D500C5EE8624E3C4',
      # y
     'F88F4B9463C7A024A98C7CAAB7784EAB71146ED4CA45A358E66A00DD32BB7E2C'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044358',
      # x
     '3ED113B7883B4C590638379DB0C21CDA16742ED0255048BF433391D374BC21D1',
      # y
     '6F66DF64333B375EDB37BC505B0B3975F6F2FB26A16776251D07110317D5C8BF'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044359',
      # x
     'CEF66D6B2A3A993E591214D1EA223FB545CA6C471C48306E4C36069404C5723F',
      # y
     '78799D5CD655517091EDC32262C4B3EFA6F212D7018AE11135CB4455BB50F88C'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044360',
      # x
     'EA68D7B6FEDF0B71878938D51D71F8729E0ACB8C2C6DF8B3D79E8A4B90949EE0',
      # y
     'D5D8BB358D36031978FEB569B5715F37B28EB0165B217DC017A5DDB5B22FB705'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044361',
      # x
     '62D9779DBEE9B0534042742D3AB54CADC1D238980FCE97DBB4DD9DC1DB6FB393',
      # y
     '52A533416E1627DCB00EA288EE98311F5D12AE0A4418958725ABF595F0F66A81'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044362',
      # x
     '8E533B6FA0BF7B4625BB30667C01FB607EF9F8B8A80FEF5B300628703187B2A3',
      # y
     '8C14E2411FCCE7CA92F9607C590A6FFFAC38C9CD34FBE4DE3AA1E5793E0BFF4B'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044363',
      # x
     'B01A172A76A4602C92D3242CB897DDE3024C740DEBB215B4C6B0AAE93C2291A9',
      # y
     '17A3EF8ACDC8252B9013F1D20458FC86E3FF0890E381E9420283B7AC7038801D'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044364',
      # x
     '51590B7A515140D2D784C85608668FDFEF8C82FD1F5BE52421554A0DC3D033ED',
      # y
     '1F3E82566FB58D83751E40C9407586D9F2FED1002B27F7772E2F44BB025E925B'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044365',
      # x
     'E2534A3532D08FBBA02DDE659EE62BD0031FE2DB785596EF509302446B030852',
      # y
     '1F0EA8A4B39CC339E62011A02579D289B103693D0CF11FFAA3BD3DC0E7B12739'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044366',
      # x
     '5ECBE4D1A6330A44C8F7EF951D4BF165E6C6B721EFADA985FB41661BC6E7FD6C',
      # y
     '78CB9BF2B6670082C8B4F931E59B5D1327D54FCAC7B047C265864ED85D82AFCD'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044367',
      # x
     '7CF27B188D034F7E8A52380304B51AC3C08969E277F21B35A60B48FC47669978',
      # y
     'F888AAEE24712FC0D6C26539608BCF244582521AC3167DD661FB4862DD878C2E'
      ),
      # k
    ('115792089210356248762697446949407573529996955224135760342422259061068512044368',
      # x
     '6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296',
      # y
     'B01CBD1C01E58065711814B583F061E9D431CCA994CEA1313449BF97C840AE0A'
      ),
)

P256_sign_test_vectors = (
    #  Curve: P256
      # hash functions
    (hashlib.sha1,
      # sample
     'sample',
      # k
     '882905F1227FD620FBF2ABF21244F0BA83D0DC3A9103DBBEE43A1FB858109DB4',
      # r
     '61340C88C3AAEBEB4F6D667F672CA9759A6CCAA9FA8811313039EE4A35471D32',
      # s
     '6D7F147DAC089441BB2E2FE8F7A3FA264B9C475098FDCF6E00D7C996E1B8B7EB'),
      # hash functions
    #(hashlib.sha1,
      # sample
    # 'test',
      # k
    # '8C9520267C55D6B980DF741E56B4ADEE114D84FBFA2E62137954164028632A2E',
      # r
    # '0CBCC86FD6ABD1D99E703E1EC50069EE5C0B4BA4B9AC60E409E8EC5910D81A89',
      # s
    # '01B9D7B73DFAA60D5651EC4591A0136F87653E0FD780C3B1BC872FFDEAE479B1'),
      # hash functions
    (hashlib.sha224,
      # sample
     'sample',
      # k
     '103F90EE9DC52E5E7FB5132B7033C63066D194321491862059967C715985D473',
      # r
     '53B2FFF5D1752B2C689DF257C04C40A587FABABB3F6FC2702F1343AF7CA9AA3F',
      # s
     'B9AFB64FDC03DC1A131C7D2386D11E349F070AA432A4ACC918BEA988BF75C74C'),
    (hashlib.sha224,
      # sample
     'test',
      # k
     '669F4426F2688B8BE0DB3A6BD1989BDAEFFF84B649EEB84F3DD26080F667FAA7',
      # r
     'C37EDB6F0AE79D47C3C27E962FA269BB4F441770357E114EE511F662EC34A692',
      # s
     'C820053A05791E521FCAAD6042D40AEA1D6B1A540138558F47D0719800E18F2D'),
      # hash functions
    (hashlib.sha256,
      # sample
     'sample',
      # k
     'A6E3C57DD01ABE90086538398355DD4C3B17AA873382B0F24D6129493D8AAD60',
      # r
     'EFD48B2AACB6A8FD1140DD9CD45E81D69D2C877B56AAF991C34D0EA84EAF3716',
      # s
     'F7CB1C942D657C41D436C7A1B6E29F65F3E900DBB9AFF4064DC4AB2F843ACDA8'),
    #(hashlib.sha256,
      # sample
    # 'test',
      # k
    # 'D16B6AE827F17175E040871A1C7EC3500192C4C92677336EC2537ACAEE0008E0',
      # r
    # 'F1ABB023518351CD71D881567B1EA663ED3EFCF6C5132B354F28D3B0B7D38367',
      # s
    # '019F4113742A2B14BD25926B49C649155F267E60D3814B4C0CC84250E46F0083'),
      # hash functions
    #(hashlib.sha384,
      # sample
    # 'sample',
      # k
    # '09F634B188CEFD98E7EC88B1AA9852D734D0BC272F7D2A47DECC6EBEB375AAD4',
      # r
    # '0EAFEA039B20E9B42309FB1D89E213057CBF973DC0CFC8F129EDDDC800EF7719',
      # s
    # '4861F0491E6998B9455193E34E7B0D284DDD7149A74B95B9261F13ABDE940954'),
      # hash functions
    (hashlib.sha384,
      # sample
     'test',
      # k
     '16AEFFA357260B04B1DD199693960740066C1A8F3E8EDD79070AA914D361B3B8',
      # r
     '83910E8B48BB0C74244EBDF7F07A1C5413D61472BD941EF3920E623FBCCEBEB6',
      # s
     '8DDBEC54CF8CD5874883841D712142A56A8D0F218F5003CB0296B6B509619F2C'),
      # hash functions
    (hashlib.sha512,
      # sample
     'sample',
      # k
     '5FA81C63109BADB88C1F367B47DA606DA28CAD69AA22C4FE6AD7DF73A7173AA5',
      # r
     '8496A60B5E9B47C825488827E0495B0E3FA109EC4568FD3F8D1097678EB97F00',
      # s
     '2362AB1ADBE2B8ADF9CB9EDAB740EA6049C028114F2460F96554F61FAE3302FE'),
    # hash functions
    (hashlib.sha512,
      # sample
     'test',
      # k
     '6915D11632ACA3C40D5D51C08DAF9C555933819548784480E93499000D9F0B7F',
      # r
     '461D93F31B6540894788FD206C07CFA0CC35F46FA3C91816FFF1040AD1581A04',
      # s
     '39AF9F15DE0DB8D97E72719C74820D304CE5226E32DEDAE67519E840D1194E55'),
)

#
# def test_vectors_ECC_P256_multiplication():
#     p1 = ECPoint(int('6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296',16), int('4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5',16), ec = EC_curve_secp256r1)
#     for k, x, y in P256_test_vectors:
#       p = p1.multiplyPointByScalar(int(k))
#       assert (format(p.x,'X') == x)
#       #assert (format(p.y,'X') == y)

#
def test_vectors_ECC_P256_sum():

    _p = p1 = ECPoint(int('6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296',16), int('4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5',16), ec = EC_curve_secp256r1)
    for k, x, y in P256_test_vectors[1:20]:
      _p = p = p1.sum(_p)
      assert (format(p.x,'X') == x)
      #assert (format(p.y,'X') == y)

#
def test_vectors_ECC_P256_sign():
    sk = 'C9AFA9D845BA75166B5C215767B1D6934E50C3DB36E89B127B8A622B120F6721'
    pk = ECPoint(int('60FED4BA255A9D31C961EB74C6356D68C049B8923B61FA6CE669622E60F29FB6',16), int('7903FE1008B8BC99A41AE9E95628BC64F2F1B20C2D7E9F5177A3C294D4462299',16), ec = EC_curve_secp192r1)
    Alice = EC_ElGamal(ec = EC_curve_secp256r1)
    for hash, message, k, r, s in P256_sign_test_vectors:
      r_, s_ = Alice.sign(data = message.encode(), sk = int(sk, 16) , hash = hash, k = int(k, 16))
      assert (format(r_, 'X') == r)
      #assert (format(s_, 'X') == s)

#
# def test_vectors_ECC_P192_multiplication():
#     p1 = ECPoint(int('188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012',16), int('07192B95FFC8DA78631011ED6B24CDD573F977A11E794811',16), ec = EC_curve_secp192r1)
#     for k, x, y in P192_test_vectors:
#       p = p1.multiplyPointByScalar(int(k))
#       assert (format(p.x,'X') == x)
#       #assert (format(p.y,'X') == y)


#
def test_vectors_ECC_P192_sum():
    _p = p1 = ECPoint(int('188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012',16), int('07192B95FFC8DA78631011ED6B24CDD573F977A11E794811',16), ec = EC_curve_secp192r1)
    for k, x, y in P192_test_vectors[1:20]:
      _p = p = p1.sum(_p)
      assert (format(p.x,'X') == x)
      #assert (format(p.y,'X') == y)

def test_vectors_ECC_P192_sign():
    sk = '6FAB034934E4C0FC9AE67F5B5659A9D7D1FEFD187EE09FD4'
    pk = ECPoint(int('AC2C77F529F91689FEA0EA5EFEC7F210D8EEA0B9E047ED56',16), int('3BC723E57670BD4887EBC732C523063D0A7C957BC97C1C43',16), ec = EC_curve_secp192r1)
    Alice = EC_ElGamal(ec = EC_curve_secp192r1)
    for hash, message, k, r, s in P192_sign_test_vectors:
      r_, s_ = Alice.sign(data = message.encode(), sk = int(sk, 16) , hash = hash, k = int(k, 16))
      assert (format(r_, 'X') == r)
      #assert (format(s_, 'X') == s)
